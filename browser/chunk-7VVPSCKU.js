import{a as xe}from"./chunk-O54LDZM6.js";import{a as be}from"./chunk-BDTP3XYN.js";import{a as N}from"./chunk-PKOGN4VO.js";import{a as Ye}from"./chunk-GJZEQUDA.js";import{a as De,c as we}from"./chunk-K4MEQIZ7.js";import{$ as Re,A as F,B as G,C as de,Ca as ae,D as me,Da as Te,E as ue,F as Le,Fa as ke,Ga as H,H as oe,Ha as Y,I as ie,Ia as D,J as $,K as V,Ka as ye,L as W,M as he,Ma as Ue,N as j,Na as Pe,Oa as qe,Pa as Ee,Qa as He,V as _,W as fe,X as Ae,Y as je,Z as P,_ as _e,a as te,aa as ze,b as Ve,c as pe,ca as v,da as ge,e as Be,f as C,g as S,ga as $e,h as O,i as l,j as h,ja as E,k as f,ka as U,l as I,la as Ce,m as s,ma as Se,na as Ie,oa as ve,pa as ne,q as r,qa as B,r as a,ra as Ge,s as M,sa as re,t as x,ta as q,u as d,ua as T,v as g,wa as k,x as z,xa as We,y as u,z as Ne}from"./chunk-BR66K6D3.js";import"./chunk-IPXLKNFD.js";import"./chunk-7KGURMOZ.js";import"./chunk-ZYUIEBGB.js";import"./chunk-5Z6BILBO.js";import"./chunk-ETSLECS3.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-C3VUKG7J.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as ee,f as R}from"./chunk-RW4GY4BD.js";var b=class{constructor(i,m,e,t,o,p){this.projectId=i,this.projectName=m,this.description=e,this.status=t,this.startDate=o,this.dueDate=p}};var y=class{constructor(i,m,e,t,o,p,c,A){this.projectTaskId=i,this.projectId=m,this.title=e,this.description=t,this.status=o,this.startDate=p,this.dueDate=c,this.assignedEmployeeIds=A}};var L=(()=>{let i=class i{constructor(){this.projectTasksChangedSource=new te,this.projectTasksChanged$=this.projectTasksChangedSource.asObservable(),this.projectTaskId=5,this.projectTasks=[new y(1,1,"Task 1","Task for Project Alpha","Completed",new Date("2024-11-13"),new Date("2024-12-13"),[0,1]),new y(2,1,"Task 2","Another Task for Project Alpha","Active",new Date("2024-12-13"),new Date("2025-1-13"),[3]),new y(3,2,"Task 3","Task for Project Beta","Completed",new Date("2025-1-13"),new Date("2025-2-13"),[1]),new y(4,2,"Task 4","Another Task for Project Beta","Active",new Date("2024-11-13"),new Date("2025-2-13"),[1])]}getProjectTasks(){return this.projectTasks}getListOfProjectTaskIdsByProjectIds(e){let t=[];for(var o of this.projectTasks)o.projectId===e&&t.push(o.projectTaskId);return t}getTasksByProjectId(e){return this.projectTasks.filter(t=>t.projectId===e)}getProjectTaskById(e){return this.projectTasks.find(t=>t.projectTaskId===e)}createProjectTask(e){e.projectTaskId=this.projectTaskId++,this.projectTasks.push(e),this.projectTasksChangedSource.next()}updateProjectTask(e){let t=this.projectTasks.findIndex(o=>o.projectTaskId===e.projectTaskId);t!==-1&&(this.projectTasks[t]=e,this.projectTasksChangedSource.next())}deleteProjectTask(e){let t=this.projectTasks.findIndex(o=>o.projectTaskId===e);t!==-1&&(this.projectTasks.splice(t,1),this.projectTasksChangedSource.next())}notifyProjectTasksChanged(){this.projectTasksChangedSource.next()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=pe({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();function rt(n,i){if(n&1&&(r(0,"ion-item")(1,"ion-text"),u(2),a()()),n&2){let m=i.$implicit,e=g(2);l(2),G(" ",e.getEmployeeNameByEmployeeId(m)," - ",e.getRoleNameByEmployeeId(m)," ")}}function at(n,i){if(n&1&&(r(0,"div")(1,"ion-list")(2,"ion-list-header"),u(3," Assigned Employees: "),a(),I(4,rt,3,2,"ion-item",2),a()()),n&2){let m=g();l(4),s("ngForOf",m.projectTask.assignedEmployeeIds)}}function st(n,i){n&1&&u(0,` No assigned employees
`)}var Je=(()=>{let i=class i{constructor(e,t,o){this._projectTaskService=e,this._employeeService=t,this._roleService=o,this.projectTaskId=0,this.projectTask=new y(0,0,"","","Not Started"),this.destroy$=new te}ngOnInit(){this.getProjectTaskById(),this._projectTaskService.projectTasksChanged$.pipe(Ve(this.destroy$)).subscribe(()=>{this.getProjectTaskById()})}getProjectTaskById(){this.projectTask=this._projectTaskService.getProjectTaskById(this.projectTaskId)}getEmployeeNameByEmployeeId(e){let t=this._employeeService.getEmployee(e);return t?t.name:"Unassigned"}getRoleNameByEmployeeId(e){let t=this._employeeService.getEmployee(e);if(t){let o=t.roleId;return o!=-1?this._roleService.getRole(o).roleName:"Unable to get role"}return"Unable to get employee"}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};i.\u0275fac=function(t){return new(t||i)(h(L),h(xe),h(be))},i.\u0275cmp=f({type:i,selectors:[["app-assigned-employee-list"]],inputs:{projectTaskId:"projectTaskId"},decls:3,vars:2,consts:[["noAssignedEmployees",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"]],template:function(t,o){if(t&1&&I(0,at,5,1,"div",1)(1,st,1,0,"ng-template",null,0,$),t&2){let p=z(2);s("ngIf",o.projectTask.assignedEmployeeIds)("ngIfElse",p)}},dependencies:[j,V,W,k,We,T,ke],styles:["ion-text[_ngcontent-%COMP%]{font-size:x-small}ion-list[_ngcontent-%COMP%]{--min-height: 16px}ion-list-header[_ngcontent-%COMP%]{padding:0;min-height:12px;font-size:small}ion-item[_ngcontent-%COMP%]{--min-height: 16px}"]});let n=i;return n})();function lt(n,i){if(n&1&&(r(0,"ion-select-option",3),u(1),a()),n&2){let m=i.$implicit;s("value",m),l(),F(" ",m," ")}}var J=(()=>{let i=class i{constructor(){this.status="",this.statusSelectedEvent=new O,this.statuses=["Not Started","Active","Completed"]}onStatusChange(e){this.status=e.detail.value,this.statusSelectedEvent.emit(this.status)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-status-selector"]],inputs:{status:"status"},outputs:{statusSelectedEvent:"statusSelectedEvent"},decls:4,vars:2,consts:[["placeholder","Status: ",3,"ionChange","value"],["slot","label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,o){t&1&&(r(0,"ion-select",0),d("ionChange",function(c){return o.onStatusChange(c)}),r(1,"div",1),u(2,"Status: "),a(),I(3,lt,2,2,"ion-select-option",2),a()),t&2&&(s("value",o.status),l(3),s("ngForOf",o.statuses))},dependencies:[j,V,Ee,Te],encapsulation:2});let n=i;return n})();var K=(()=>{let i=class i{constructor(){this.value="",this.label="text",this.placeholder="",this.valueChanged=new O}ngOnInit(){this.placeholder=`Enter ${this.label} here`}onInputChange(e){this.value=e.target.value,this.valueChanged.emit(this.value)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-input"]],inputs:{value:"value",label:"label"},outputs:{valueChanged:"valueChanged"},decls:1,vars:3,consts:[[3,"ionInput","value","label","placeholder"]],template:function(t,o){t&1&&(r(0,"ion-input",0),d("ionInput",function(c){return o.onInputChange(c)}),a()),t&2&&s("value",o.value)("label",o.label+":")("placeholder",o.placeholder)},dependencies:[j,v,qe],encapsulation:2});let n=i;return n})();var Q=(()=>{let i=class i{constructor(){this.text="",this.label="",this.placeholder="",this.rows=3,this.textChanged=new O}ngOnInit(){this.placeholder=`Enter ${this.label} here`}onTextChange(e){this.text=e.target.value,this.textChanged.emit(this.text)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-text-area"]],inputs:{text:"text",label:"label",rows:"rows"},outputs:{textChanged:"textChanged"},decls:2,vars:5,consts:[[1,"text-area-container"],[1,"full-width",3,"ionInput","value","label","placeholder","rows","autoGrow"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"ion-textarea",1),d("ionInput",function(c){return o.onTextChange(c)}),a()()),t&2&&(l(),s("value",o.text)("label",o.label+":")("placeholder",o.placeholder)("rows",o.rows)("autoGrow",!0))},dependencies:[j,v,He],encapsulation:2});let n=i;return n})();function ct(n,i){if(n&1){let m=x();r(0,"ion-datetime",5),ue("ngModelChange",function(t){C(m);let o=g();return me(o.selectedDate,t)||(o.selectedDate=t),S(t)}),d("ionChange",function(t){C(m);let o=g();return S(o.onDateChange(t))}),a()}if(n&2){let m=g();s("id",m.datetimeId)("showDefaultTitle",!0)("showDefaultButtons",!0),de("ngModel",m.selectedDate)}}var X=(()=>{let i=class i{constructor(){this.label="",this.date=new Date,this.dateSelected=new O,this.selectedDate=new Date().toISOString(),this.datetimeId=`datetime-${Math.random().toString(36).substring(2,9)}`}ngOnInit(){this.date&&(this.selectedDate=this.date.toISOString()),this.dateSelected.emit(this.selectedDate)}onDateChange(e){this.selectedDate=e.detail.value,this.dateSelected.emit(this.selectedDate)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-date-selector"]],inputs:{label:"label",date:"date"},outputs:{dateSelected:"dateSelected"},decls:8,vars:4,consts:[[3,"fixed"],["size","auto",1,"ion-align-self-center"],["size","auto"],[3,"datetime"],[3,"keepContentsMounted"],["presentation","date","doneText","SELECT","cancelText","CANCEL",3,"ngModelChange","ionChange","id","showDefaultTitle","showDefaultButtons","ngModel"]],template:function(t,o){t&1&&(r(0,"ion-grid",0)(1,"ion-row")(2,"ion-col",1),u(3),a(),r(4,"ion-col",2),M(5,"ion-datetime-button",3),r(6,"ion-modal",4),I(7,ct,1,4,"ng-template"),a()()()()),t&2&&(s("fixed",!0),l(3),F(" ",o.label,": "),l(2),s("datetime",o.datetimeId),l(),s("keepContentsMounted",!0))},dependencies:[v,fe,_e,ge,re,ae,ne,Ue,Ge,$e],encapsulation:2});let n=i;return n})();function pt(n,i){if(n&1&&(r(0,"ion-select-option",3),u(1),a()),n&2){let m=i.$implicit,e=g();s("value",m),l(),G(" ",m.name," - ",e.getRoleName(m.roleId)," ")}}var Me=(()=>{let i=class i{constructor(e,t){this._employeeService=e,this._roleService=t,this.employees=[],this.assignedEmployeeIds=[],this.employeesSelectedEvent=new O,this.selectedEmployees=[]}ngOnInit(){this.getEmployees(),this.selectedEmployees=this.employees.filter(e=>this.assignedEmployeeIds.includes(e.employeeId))}ngOnChanges(e){e.assignedEmployeeIds&&this.employees.length&&(this.selectedEmployees=this.employees.filter(t=>this.assignedEmployeeIds.includes(t.employeeId)))}getEmployees(){this.employees=this._employeeService.getEmployees()}getRoleName(e){let t=this._roleService.getRole(e);return t?t.roleName:"Unable to get role"}onEmployeeChange(e){this.selectedEmployees=e.detail.value;let t=this.selectedEmployees.map(o=>o.employeeId);this.employeesSelectedEvent.emit(t)}compareEmployees(e,t){return e&&t?e.employeeId===t.employeeId:e===t}};i.\u0275fac=function(t){return new(t||i)(h(xe),h(be))},i.\u0275cmp=f({type:i,selectors:[["app-assign-employees"]],inputs:{assignedEmployeeIds:"assignedEmployeeIds"},outputs:{employeesSelectedEvent:"employeesSelectedEvent"},features:[Be],decls:4,vars:4,consts:[["placeholder","Select Employees",3,"ngModelChange","ionChange","multiple","ngModel","compareWith"],["slot","label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,o){t&1&&(r(0,"ion-select",0),ue("ngModelChange",function(c){return me(o.selectedEmployees,c)||(o.selectedEmployees=c),c}),d("ionChange",function(c){return o.onEmployeeChange(c)}),r(1,"div",1),u(2,"Employees: "),a(),I(3,pt,2,3,"ion-select-option",2),a()),t&2&&(s("multiple",!0),de("ngModel",o.selectedEmployees),s("compareWith",o.compareEmployees),l(3),s("ngForOf",o.employees))},dependencies:[j,V,v,fe,_e,Ee,Te],encapsulation:2});let n=i;return n})();var dt=()=>[];function mt(n,i){if(n&1){let m=x();r(0,"app-date-selector",11),d("dateSelected",function(t){C(m);let o=g();return S(o.handleStartDateSelection(t))}),a()}if(n&2){let m=g();s("label","Start Date")("date",m.editedProjectTask.startDate)}}function ut(n,i){if(n&1){let m=x();r(0,"app-date-selector",12),d("dateSelected",function(t){C(m);let o=g();return S(o.handleStartDateSelection(t))}),a()}n&2&&s("label","Start Date")}function ht(n,i){if(n&1){let m=x();r(0,"app-date-selector",11),d("dateSelected",function(t){C(m);let o=g();return S(o.handleDueDateSelection(t))}),a()}if(n&2){let m=g();s("label","Due Date")("date",m.editedProjectTask.dueDate)}}function ft(n,i){if(n&1){let m=x();r(0,"app-date-selector",12),d("dateSelected",function(t){C(m);let o=g();return S(o.handleDueDateSelection(t))}),a()}n&2&&s("label","Due Date")}var Qe=(()=>{let i=class i{constructor(e,t,o){this.modalCtrl=e,this._projectTaskService=t,this._toastService=o,this.projectTaskId=-1,this.originalProjectTask=new y(-1,0,"","","Not Started",new Date,new Date,[]),this.editedProjectTask=new y(-1,0,"","","Not Started",new Date,new Date,[]),this.statuses=["Not Started","Active","Completed"],this.startDateString="",this.dueDateString="",this.assignedEmployees=[]}ngOnInit(){this.getProjectTask()}getProjectTask(){let e=this._projectTaskService.getProjectTaskById(this.projectTaskId);e?(this.originalProjectTask=ee({},e),this.editedProjectTask=ee({},e)):this._toastService.presentErrorToast("Unable to retrieve project task.")}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.saveChanges(),this.modalCtrl.dismiss(this.projectTaskId,"confirm")}handleTitleChange(e){this.editedProjectTask.title=e}handleStatusChange(e){this.editedProjectTask.status=e}handleDescriptionChange(e){this.editedProjectTask.description=e}handleStartDateSelection(e){let t=new Date(e);this.editedProjectTask.startDate=t}handleDueDateSelection(e){let t=new Date(e);this.editedProjectTask.dueDate=t}handleEmployeeSelection(e){this.editedProjectTask.assignedEmployeeIds=e}saveChanges(){this._projectTaskService.updateProjectTask(this.editedProjectTask),this._projectTaskService.notifyProjectTasksChanged(),this._toastService.presentSuccessToast("Project task updated.")}};i.\u0275fac=function(t){return new(t||i)(h(D),h(L),h(N))},i.\u0275cmp=f({type:i,selectors:[["app-project-task-edit-modal"]],inputs:{projectTaskId:"projectTaskId"},decls:28,vars:12,consts:[["startDateSelector",""],["dueDateSelector",""],["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"click","strong"],[3,"valueChanged","label","value"],[3,"textChanged","label","text"],[3,"statusSelectedEvent","status"],[3,"label","date","dateSelected",4,"ngIf","ngIfElse"],[3,"employeesSelectedEvent","assignedEmployeeIds"],[3,"dateSelected","label","date"],[3,"dateSelected","label"]],template:function(t,o){if(t&1){let p=x();r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",2)(3,"ion-button",3),d("click",function(){return C(p),S(o.cancel())}),u(4,"Cancel"),a()(),r(5,"ion-title"),u(6,"Edit Project Task"),a(),r(7,"ion-buttons",4)(8,"ion-button",5),d("click",function(){return C(p),S(o.confirm())}),u(9,"Confirm"),a()()()(),r(10,"ion-content")(11,"ion-list")(12,"ion-item")(13,"app-input",6),d("valueChanged",function(A){return C(p),S(o.handleTitleChange(A))}),a()(),r(14,"ion-item")(15,"app-text-area",7),d("textChanged",function(A){return C(p),S(o.handleDescriptionChange(A))}),a()(),r(16,"ion-item")(17,"app-status-selector",8),d("statusSelectedEvent",function(A){return C(p),S(o.handleStatusChange(A))}),a()(),r(18,"ion-item"),I(19,mt,1,2,"app-date-selector",9)(20,ut,1,1,"ng-template",null,0,$),a(),r(22,"ion-item"),I(23,ht,1,2,"app-date-selector",9)(24,ft,1,1,"ng-template",null,1,$),a(),r(26,"ion-item")(27,"app-assign-employees",10),d("employeesSelectedEvent",function(A){return C(p),S(o.handleEmployeeSelection(A))}),a()()()()}if(t&2){let p=z(21),c=z(25);l(8),s("strong",!0),l(5),s("label","Task")("value",o.editedProjectTask.title),l(2),s("label","Description")("text",o.editedProjectTask.description),l(2),s("status",o.editedProjectTask.status),l(2),s("ngIf",o.editedProjectTask.startDate)("ngIfElse",p),l(4),s("ngIf",o.editedProjectTask.dueDate)("ngIfElse",c),l(4),s("assignedEmployeeIds",o.editedProjectTask.assignedEmployeeIds||Le(11,dt))}},dependencies:[j,W,v,E,U,H,B,q,Y,k,T,J,K,Q,X,Me],encapsulation:2});let n=i;return n})();var Xe=(()=>{let i=class i{constructor(e,t,o){this._projectTaskService=e,this.actionSheetCtrl=t,this.modalCtrl=o,this.projectTaskId=0,this.projectTask=new y(0,0,"","","Not Started"),this.titleInvalid=!1,this.descriptionInvalid=!1,this.startDateString="",this.dueDateString="",De({ellipsisVerticalSharp:we})}ngOnInit(){this.getProjectTaskById(),this.syncDateStrings()}getProjectTaskById(){this.projectTask=this._projectTaskService.getProjectTaskById(this.projectTaskId),this.syncDateStrings()}syncDateStrings(){this.startDateString=this.formatDate(this.projectTask.startDate),this.dueDateString=this.formatDate(this.projectTask.dueDate)}formatDate(e){if(!e)return"";let t=new Date(e),o=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return`${o}-${p}-${c}`}presentProjectTaskActionSheet(){return R(this,null,function*(){yield(yield this.actionSheetCtrl.create({header:this.projectTask.title,buttons:[{text:"Edit",handler:()=>this.openProjectTaskEditModal()},{text:"Delete",role:"destructive",handler:()=>this.onDelete()},{text:"Cancel",role:"cancel",data:{action:"cancel"}}]})).present()})}openProjectTaskEditModal(){return R(this,null,function*(){let e=yield this.modalCtrl.create({component:Qe,componentProps:{projectTaskId:this.projectTaskId}});e.present();let{data:t,role:o}=yield e.onWillDismiss();o==="confirm"&&this.getProjectTaskById()})}onDelete(){confirm("Are you sure you want to delete this projectTask?")&&this._projectTaskService.deleteProjectTask(this.projectTaskId)}};i.\u0275fac=function(t){return new(t||i)(h(L),h(ye),h(D))},i.\u0275cmp=f({type:i,selectors:[["app-project-task"]],inputs:{projectTaskId:"projectTaskId"},decls:24,vars:14,consts:[[1,"project-task-card"],[1,"ion-no-padding"],[1,"ion-justify-content"],["size","6",1,"ion-align-self-center","status"],["size","4",1,"ion-align-self-center","ion-text-end","status"],["size","2",1,"ion-text-end"],["fill","clear","size","small",3,"click"],["slot","icon-only","name","ellipsis-vertical-sharp"],[3,"projectTaskId"]],template:function(t,o){t&1&&(r(0,"ion-card",0)(1,"ion-card-header")(2,"ion-grid")(3,"ion-row")(4,"ion-grid",1)(5,"ion-row",2)(6,"ion-col",3),u(7),oe(8,"date"),oe(9,"date"),a(),r(10,"ion-col",4),u(11),a(),r(12,"ion-col",5)(13,"ion-button",6),d("click",function(){return o.presentProjectTaskActionSheet()}),M(14,"ion-icon",7),a()()()()()()(),r(15,"ion-card-content")(16,"ion-list")(17,"ion-card-title"),u(18),a(),r(19,"ion-item")(20,"ion-text"),u(21),a()(),r(22,"ion-item"),M(23,"app-assigned-employee-list",8),a()()()()),t&2&&(l(7),G(" ",ie(8,6,o.projectTask.startDate,"shortDate","UTC")," - ",ie(9,10,o.projectTask.dueDate,"shortDate","UTC")," "),l(4),F(" ",o.projectTask.status," "),l(7),F(" ",o.projectTask.title," "),l(3),F(" ",o.projectTask.description," "),l(2),s("projectTaskId",o.projectTaskId))},dependencies:[j,he,Ce,Ie,ve,E,Pe,re,ae,ne,Se,k,T,ke,Je],styles:["ion-card[_ngcontent-%COMP%]{margin:0;padding:0}ion-grid[_ngcontent-%COMP%]{margin:0;padding:0}ion-card-header[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}ion-text[_ngcontent-%COMP%]{font-size:small}.status[_ngcontent-%COMP%]{font-size:x-small}ion-card-header[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px;font-size:medium}ion-col[_ngcontent-%COMP%]{top:50%}ion-item[_ngcontent-%COMP%]{--min-height: 16px}.date[_ngcontent-%COMP%]{font-size:10px}"]});let n=i;return n})();var Z=(()=>{let i=class i{constructor(){this.projectsChangedSource=new te,this.projectsChanged$=this.projectsChangedSource.asObservable(),this.projectId=3,this.projects=[new b(1,"Project Alpha","First project","Active",new Date("2024-11-13"),new Date("2025-11-13")),new b(2,"Project Beta","Second project","Active",new Date("2024-11-13"),new Date("2025-1-13"))]}getProjects(){return this.projects}getListOfProjectIds(){let e=[];return this.projects.forEach(t=>{e.push(t.projectId)}),e}getProjectById(e){return this.projects.find(t=>t.projectId===e)}createProject(e){e.projectId=this.projectId++,this.projects.push(e),this.projectsChangedSource.next()}updateProject(e){let t=this.projects.findIndex(o=>o.projectId===e.projectId);t!==-1&&(this.projects[t]=e,this.projectsChangedSource.next())}deleteProject(e){let t=this.projects.findIndex(o=>o.projectId===e);t!==-1&&(this.projects.splice(t,1),this.projectsChangedSource.next())}notifyProjectsChanged(){this.projectsChangedSource.next()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=pe({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var Ze=(()=>{let i=class i{constructor(e,t,o){this.modalCtrl=e,this._projectService=t,this._toastService=o,this.projectId=-1,this.originalProject=new b(-1,"","","Not Started",new Date,new Date),this.editedProject=new b(-1,"","","Not Started",new Date,new Date)}ngOnInit(){this.getProject()}getProject(){let e=this._projectService.getProjectById(this.projectId);e?(this.originalProject=ee({},e),this.editedProject=ee({},e)):this._toastService.presentErrorToast("Unable to retrieve project")}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.saveChanges(),this.modalCtrl.dismiss(this.projectId,"confirm")}handleProjectNameChange(e){this.editedProject.projectName=e}handleStatusChange(e){this.editedProject.status=e}handleDescriptionChange(e){this.editedProject.description=e}handleStartDateSelection(e){let t=new Date(e);this.editedProject.startDate=t}handleDueDateSelection(e){let t=new Date(e);this.editedProject.dueDate=t}saveChanges(){this._projectService.updateProject(this.editedProject),this._projectService.notifyProjectsChanged(),this._toastService.presentSuccessToast("Project saved.")}};i.\u0275fac=function(t){return new(t||i)(h(D),h(Z),h(N))},i.\u0275cmp=f({type:i,selectors:[["app-project-edit-modal"]],inputs:{projectId:"projectId"},decls:22,vars:10,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"click","strong"],[3,"valueChanged","label","value"],[3,"statusSelectedEvent","status"],[3,"textChanged","label","text"],[3,"dateSelected","label","date"]],template:function(t,o){t&1&&(r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),d("click",function(){return o.cancel()}),u(4,"Cancel"),a()(),r(5,"ion-title"),u(6,"Edit Project"),a(),r(7,"ion-buttons",2)(8,"ion-button",3),d("click",function(){return o.confirm()}),u(9,"Confirm"),a()()()(),r(10,"ion-content")(11,"ion-list")(12,"ion-item")(13,"app-input",4),d("valueChanged",function(c){return o.handleProjectNameChange(c)}),a()(),r(14,"ion-item")(15,"app-status-selector",5),d("statusSelectedEvent",function(c){return o.handleStatusChange(c)}),a()(),r(16,"ion-item")(17,"app-text-area",6),d("textChanged",function(c){return o.handleDescriptionChange(c)}),a()(),r(18,"ion-item")(19,"app-date-selector",7),d("dateSelected",function(c){return o.handleStartDateSelection(c)}),a()(),r(20,"ion-item")(21,"app-date-selector",7),d("dateSelected",function(c){return o.handleDueDateSelection(c)}),a()()()()),t&2&&(l(8),s("strong",!0),l(5),s("label","Project")("value",o.editedProject.projectName),l(2),s("status",o.editedProject.status),l(2),s("label","Description")("text",o.editedProject.description),l(2),s("label","Start Date")("date",o.editedProject.startDate),l(2),s("label","Due Date")("date",o.editedProject.dueDate))},dependencies:[j,v,q,Y,U,E,H,B,k,T,K,J,Q,X],encapsulation:2});let n=i;return n})();var et=(()=>{let i=class i{constructor(e,t,o){this.modalCtrl=e,this._projectTaskService=t,this._toastService=o,this.projectId=-1,this.projectTaskForm=new je({projectId:new P(0,[_.required,_.minLength(2),_.maxLength(50)]),title:new P("",[_.required,_.minLength(2),_.maxLength(50)]),description:new P("",[_.required,_.minLength(2),_.maxLength(50)]),status:new P("",[_.required,_.minLength(2),_.maxLength(50)]),startDate:new P(""),dueDate:new P(""),assignedEmployeeIds:new P([])})}ngOnInit(){this.assignProjectId()}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.projectTaskForm.valid?(this.createProjectTask(),this.modalCtrl.dismiss("confirm")):this.modalCtrl.dismiss("confirm")}assignProjectId(){this.projectTaskForm.controls.projectId.setValue(this.projectId)}handleTitleChange(e){this.projectTaskForm.controls.title.setValue(e)}handleDescriptionChange(e){this.projectTaskForm.controls.description.setValue(e)}handleStatusChange(e){this.projectTaskForm.controls.status.setValue(e)}handleStartDateSelection(e){let t=new Date(e);this.projectTaskForm.controls.startDate.setValue(t)}handleDueDateSelection(e){let t=new Date(e);this.projectTaskForm.controls.dueDate.setValue(t)}handleEmployeeSelection(e){this.projectTaskForm.controls.assignedEmployeeIds.setValue(e)}createProjectTask(){let e=new y(0,this.projectTaskForm.controls.projectId.value,this.projectTaskForm.controls.title.value,this.projectTaskForm.controls.description.value,this.projectTaskForm.controls.status.value,this.projectTaskForm.controls.startDate.value,this.projectTaskForm.controls.dueDate.value,this.projectTaskForm.controls.assignedEmployeeIds.value);this._projectTaskService.createProjectTask(e),this._projectTaskService.notifyProjectTasksChanged(),this._toastService.presentSuccessToast("Project task created.")}};i.\u0275fac=function(t){return new(t||i)(h(D),h(L),h(N))},i.\u0275cmp=f({type:i,selectors:[["app-project-task-create-modal"]],inputs:{projectId:"projectId"},decls:24,vars:6,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"click","strong"],[3,"valueChanged","label"],[3,"textChanged","label"],[3,"statusSelectedEvent"],[3,"dateSelected","label"],[3,"employeesSelectedEvent","assignedEmployeeIds"]],template:function(t,o){t&1&&(r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),d("click",function(){return o.cancel()}),u(4,"Cancel"),a()(),r(5,"ion-title"),u(6,"Edit Project Task"),a(),r(7,"ion-buttons",2)(8,"ion-button",3),d("click",function(){return o.confirm()}),u(9,"Confirm"),a()()()(),r(10,"ion-content")(11,"ion-list")(12,"ion-item")(13,"app-input",4),d("valueChanged",function(c){return o.handleTitleChange(c)}),a()(),r(14,"ion-item")(15,"app-text-area",5),d("textChanged",function(c){return o.handleDescriptionChange(c)}),a()(),r(16,"ion-item")(17,"app-status-selector",6),d("statusSelectedEvent",function(c){return o.handleStatusChange(c)}),a()(),r(18,"ion-item")(19,"app-date-selector",7),d("dateSelected",function(c){return o.handleStartDateSelection(c)}),a()(),r(20,"ion-item")(21,"app-date-selector",7),d("dateSelected",function(c){return o.handleDueDateSelection(c)}),a()(),r(22,"ion-item")(23,"app-assign-employees",8),d("employeesSelectedEvent",function(c){return o.handleEmployeeSelection(c)}),a()()()()),t&2&&(l(8),s("strong",!0),l(5),s("label","Task"),l(2),s("label","Description"),l(4),s("label","Start Date"),l(2),s("label","Due Date"),l(2),s("assignedEmployeeIds",o.projectTaskForm.value.assignedEmployeeIds))},dependencies:[j,v,q,Y,U,E,H,B,k,T,K,Q,J,X,Me],encapsulation:2});let n=i;return n})();function jt(n,i){if(n&1&&(r(0,"div"),u(1),oe(2,"date"),oe(3,"date"),a()),n&2){let m=g();l(),G(" ",ie(2,2,m.project.startDate,"shortDate","UTC")," - ",ie(3,6,m.project.dueDate,"shortDate","UTC")," ")}}function _t(n,i){if(n&1&&(r(0,"ion-list",17)(1,"ion-item"),M(2,"app-project-task",18),a()()),n&2){let m=i.$implicit;l(2),s("projectTaskId",m)}}function gt(n,i){if(n&1&&(r(0,"div"),I(1,_t,3,1,"ion-list",16),a()),n&2){let m=g();l(),s("ngForOf",m.listOfProjectTaskIds)}}function Ct(n,i){n&1&&u(0," No Project Tasks ")}var tt=(()=>{let i=class i{constructor(e,t,o,p,c){this._projectService=e,this._projectTaskService=t,this.actionSheetCtrl=o,this.modalCtrl=p,this._toastService=c,this.projectId=0,this.project=new b(0,"","","Not Started",new Date,new Date),this.listOfProjectTaskIds=[],this.projectNameInvalid=!1,this.descriptionInvalid=!1,this.startDateString="",this.dueDateString="",De({ellipsisVerticalSharp:we})}ngOnInit(){this.getProjectById(),this.getListOfProjectTaskIdsByProjectId(),this._projectService.projectsChanged$.subscribe(()=>{this.getProjectById()}),this._projectTaskService.projectTasksChanged$.subscribe(()=>{this.getListOfProjectTaskIdsByProjectId()})}getProjectById(){this.project=this._projectService.getProjectById(this.projectId)}getListOfProjectTaskIdsByProjectId(){this.listOfProjectTaskIds=this._projectTaskService.getListOfProjectTaskIdsByProjectIds(this.projectId)}presentProjectActionSheet(){return R(this,null,function*(){yield(yield this.actionSheetCtrl.create({header:this.project.projectName,buttons:[{text:"Edit Project",handler:()=>this.openProjectEditModal()},{text:"Add Project Task",handler:()=>this.openProjectTaskCreateModal()},{text:"Delete Project",role:"destructive",handler:()=>this.onDelete(this.project.projectId)},{text:"Cancel",role:"cancel",data:{action:"cancel"}}]})).present()})}openProjectTaskCreateModal(){return R(this,null,function*(){let e=yield this.modalCtrl.create({component:et,componentProps:{projectId:this.projectId}});e.present();let{data:t,role:o}=yield e.onWillDismiss()})}openProjectEditModal(){return R(this,null,function*(){let e=yield this.modalCtrl.create({component:Ze,componentProps:{projectId:this.projectId}});e.present();let{data:t,role:o}=yield e.onWillDismiss()})}onDelete(e){confirm("Are you sure you want to delete this project?")&&(this._projectService.deleteProject(e),this._toastService.presentSuccessToast("Department deleted."))}};i.\u0275fac=function(t){return new(t||i)(h(Z),h(L),h(ye),h(D),h(N))},i.\u0275cmp=f({type:i,selectors:[["app-project"]],inputs:{projectId:"projectId"},decls:28,vars:6,consts:[["noProjectTasksBlock",""],[1,"project-card"],[1,"ion-no-padding"],[1,"ion-justify-content"],["size","6",1,"ion-align-self-center","status"],[4,"ngIf"],["size","4",1,"ion-align-self-center","ion-text-end","status"],["size","2",1,"ion-text-end"],["fill","clear","size","small",3,"click"],["slot","icon-only","name","ellipsis-vertical-sharp"],[1,"project-description"],[1,"tasks-section"],[1,"tasks-header"],[1,"add-task-btn",3,"click"],[1,"task-list"],[4,"ngIf","ngIfElse"],["class","ion-text-center",4,"ngFor","ngForOf"],[1,"ion-text-center"],[3,"projectTaskId"]],template:function(t,o){if(t&1){let p=x();r(0,"ion-card",1)(1,"ion-card-header")(2,"ion-grid")(3,"ion-row")(4,"ion-grid",2)(5,"ion-row",3)(6,"ion-col",4),I(7,jt,4,10,"div",5),a(),r(8,"ion-col",6),u(9),a(),r(10,"ion-col",7)(11,"ion-button",8),d("click",function(){return C(p),S(o.presentProjectActionSheet())}),M(12,"ion-icon",9),a()()()()()()(),r(13,"ion-card-content")(14,"ion-card-title"),u(15),a(),r(16,"p",10),u(17),a(),r(18,"div",11)(19,"div",12)(20,"h1"),u(21,"Tasks"),a(),r(22,"ion-button",13),d("click",function(){return C(p),S(o.openProjectTaskCreateModal())}),u(23," Add Task "),a()(),r(24,"div",14),I(25,gt,2,1,"div",15)(26,Ct,1,0,"ng-template",null,0,$),a()()()()}if(t&2){let p=z(27);l(7),s("ngIf",o.project.startDate),l(2),F(" ",o.project.status," "),l(6),F(" ",o.project.projectName," "),l(2),Ne(o.project.description),l(8),s("ngIf",o.listOfProjectTaskIds.length>0)("ngIfElse",p)}},dependencies:[j,V,W,he,Ce,Ie,re,ae,ne,Se,ve,k,T,E,Pe,Xe],styles:["ion-grid[_ngcontent-%COMP%]{margin:0;padding:0}ion-card-header[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.date[_ngcontent-%COMP%]{font-size:10px}app-project-task[_ngcontent-%COMP%]{display:block;width:100%}"]});let n=i;return n})();var ot=(()=>{let i=class i{constructor(e,t,o){this.modalCtrl=e,this._projectService=t,this._toastService=o,this.projectForm=new je({projectName:new P("",[_.required,_.minLength(2),_.maxLength(50)]),description:new P("",[_.required,_.minLength(2),_.maxLength(50)]),status:new P("",[_.required,_.minLength(2),_.maxLength(50)]),startDate:new P(""),dueDate:new P("")})}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.projectForm.valid?(this.createProject(),this.modalCtrl.dismiss("confirm")):this.modalCtrl.dismiss("confirm")}handleProjectNameChange(e){this.projectForm.controls.projectName.setValue(e)}handleStatusChange(e){this.projectForm.controls.status.setValue(e)}handleDescriptionChange(e){this.projectForm.controls.description.setValue(e)}handleStartDateSelection(e){let t=new Date(e);this.projectForm.controls.startDate.setValue(t)}handleDueDateSelection(e){let t=new Date(e);this.projectForm.controls.dueDate.setValue(t)}createProject(){let e=new b(0,this.projectForm.controls.projectName.value,this.projectForm.controls.description.value,this.projectForm.controls.status.value,this.projectForm.controls.startDate.value,this.projectForm.controls.dueDate.value);this._projectService.createProject(e),this._projectService.notifyProjectsChanged(),this._toastService.presentSuccessToast("Project created.")}};i.\u0275fac=function(t){return new(t||i)(h(D),h(Z),h(N))},i.\u0275cmp=f({type:i,selectors:[["app-project-create-modal"]],decls:23,vars:7,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"click","strong","disabled"],[3,"ngSubmit","formGroup"],[3,"valueChanged","label"],[3,"statusSelectedEvent"],[3,"textChanged","label"],[3,"dateSelected","label"]],template:function(t,o){t&1&&(r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),d("click",function(){return o.cancel()}),u(4,"Cancel"),a()(),r(5,"ion-title"),u(6,"Create Project"),a(),r(7,"ion-buttons",2)(8,"ion-button",3),d("click",function(){return o.confirm()}),u(9,"Confirm"),a()()()(),r(10,"ion-content")(11,"form",4),d("ngSubmit",function(){return o.createProject()}),r(12,"ion-list")(13,"ion-item")(14,"app-input",5),d("valueChanged",function(c){return o.handleProjectNameChange(c)}),a()(),r(15,"ion-item")(16,"app-status-selector",6),d("statusSelectedEvent",function(c){return o.handleStatusChange(c)}),a()(),r(17,"ion-item")(18,"app-text-area",7),d("textChanged",function(c){return o.handleDescriptionChange(c)}),a()(),r(19,"ion-item")(20,"app-date-selector",8),d("dateSelected",function(c){return o.handleStartDateSelection(c)}),a()(),r(21,"ion-item")(22,"app-date-selector",8),d("dateSelected",function(c){return o.handleDueDateSelection(c)}),a()()()()()),t&2&&(l(8),s("strong",!0)("disabled",!o.projectForm.valid),l(3),s("formGroup",o.projectForm),l(3),s("label","Project"),l(4),s("label","Description"),l(2),s("label","Start Date"),l(2),s("label","Due Date"))},dependencies:[j,v,Re,Ae,ge,ze,q,Y,U,E,H,B,k,T,Q,K,J,X],encapsulation:2});let n=i;return n})();function St(n,i){if(n&1&&(r(0,"ion-list")(1,"ion-item"),M(2,"app-project",7),a()()),n&2){let m=i.$implicit;l(2),s("projectId",m)}}function It(n,i){if(n&1&&(r(0,"div"),I(1,St,3,1,"ion-list",6),a()),n&2){let m=g();l(),s("ngForOf",m.listOfProjectIds)}}function vt(n,i){if(n&1){let m=x();r(0,"div",8)(1,"h3"),u(2,"No Projects Found"),a(),r(3,"p"),u(4,"Get started by creating your first project"),a(),r(5,"ion-button",4),d("click",function(){C(m);let t=g();return S(t.openProjectCreateModal())}),u(6,"Create Project"),a()()}}var wi=(()=>{let i=class i{constructor(e,t){this._projectService=e,this.modalCtrl=t,this.listOfProjectIds=[]}ngOnInit(){this.getListOfProjectIds(),this._projectService.projectsChanged$.subscribe(()=>{this.getListOfProjectIds()})}getListOfProjectIds(){this.listOfProjectIds=this._projectService.getListOfProjectIds()}openProjectCreateModal(){return R(this,null,function*(){let e=yield this.modalCtrl.create({component:ot,componentProps:{}});e.present();let{data:t,role:o}=yield e.onWillDismiss()})}};i.\u0275fac=function(t){return new(t||i)(h(Z),h(D))},i.\u0275cmp=f({type:i,selectors:[["app-projects"]],decls:8,vars:3,consts:[["noProjectBlock",""],[3,"title"],[1,"ion-padding"],[1,"ion-text-center"],[3,"click"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"projectId"],[1,"empty-state"]],template:function(t,o){if(t&1){let p=x();M(0,"app-sidemenu",1),r(1,"ion-content",2)(2,"div",3)(3,"ion-button",4),d("click",function(){return C(p),S(o.openProjectCreateModal())}),u(4,"Create New Project"),a()(),I(5,It,2,1,"div",5)(6,vt,7,0,"ng-template",null,0,$),a()}if(t&2){let p=z(7);s("title","Projects"),l(5),s("ngIf",o.listOfProjectIds.length>0)("ngIfElse",p)}},dependencies:[j,V,W,Ye,B,E,k,T,tt],styles:["app-project[_ngcontent-%COMP%]{display:block;width:100%}"]});let n=i;return n})();export{wi as ProjectsComponent};
